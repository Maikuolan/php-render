<?php 
define('EXAMPLE_DIR', __DIR__);
require __DIR__ . '/../example_base.php';

use PHPR\Context;
use PHPR\Shader\Shader;
use PHPR\Mesh\{Vertex, Vertex\VertexPNU};
use PHPR\Mesh\VertexArray;
use PHPR\Math\Vec3;

class CubeShader extends Shader
{
    /**
     * Vertex shader like thing
     */
    public function vertex(Vertex $vertex, array &$out)
    {
        $out['position'] = $vertex->position;
    }

    /**
     * Fragment shader like thing
     */
    public function fragment(array &$in, array &$out)
    {
        $out['color'] = 0xFFFFFF;
    }
}


$context = create_exmaple_context();
$context->bindShader(new CubeShader);
$context->setDrawMode(Context::DRAW_MODE_LINES);

$cube = new VertexArray(VertexPNU::class, [
    // position        // normal        // uv
     0.5, -0.5, -0.5,  0.0,  0.0, -1.0, 1.0, 0.0,
    -0.5, -0.5, -0.5,  0.0,  0.0, -1.0, 0.0, 0.0,
     0.5,  0.5, -0.5,  0.0,  0.0, -1.0, 1.0, 1.0,
    -0.5,  0.5, -0.5,  0.0,  0.0, -1.0, 0.0, 1.0,
     0.5,  0.5, -0.5,  0.0,  0.0, -1.0, 1.0, 1.0,
    -0.5, -0.5, -0.5,  0.0,  0.0, -1.0, 0.0, 0.0,
    //
    -0.5, -0.5,  0.5,  0.0,  0.0,  1.0, 0.0, 0.0,
     0.5, -0.5,  0.5,  0.0,  0.0,  1.0, 1.0, 0.0,
     0.5,  0.5,  0.5,  0.0,  0.0,  1.0, 1.0, 1.0,
     0.5,  0.5,  0.5,  0.0,  0.0,  1.0, 1.0, 1.0,
    -0.5,  0.5,  0.5,  0.0,  0.0,  1.0, 0.0, 1.0,
    -0.5, -0.5,  0.5,  0.0,  0.0,  1.0, 0.0, 0.0,
    //
    -0.5,  0.5,  0.5, -1.0,  0.0,  0.0, 1.0, 0.0,
    -0.5,  0.5, -0.5, -1.0,  0.0,  0.0, 1.0, 1.0,
    -0.5, -0.5, -0.5, -1.0,  0.0,  0.0, 0.0, 1.0,
    -0.5, -0.5, -0.5, -1.0,  0.0,  0.0, 0.0, 1.0,
    -0.5, -0.5,  0.5, -1.0,  0.0,  0.0, 0.0, 0.0,
    -0.5,  0.5,  0.5, -1.0,  0.0,  0.0, 1.0, 0.0,
    //
     0.5,  0.5, -0.5,  1.0,  0.0,  0.0, 1.0, 1.0,
     0.5,  0.5,  0.5,  1.0,  0.0,  0.0, 1.0, 0.0,
     0.5, -0.5, -0.5,  1.0,  0.0,  0.0, 0.0, 1.0,
     0.5, -0.5,  0.5,  1.0,  0.0,  0.0, 0.0, 0.0,
     0.5, -0.5, -0.5,  1.0,  0.0,  0.0, 0.0, 1.0,
     0.5,  0.5,  0.5,  1.0,  0.0,  0.0, 1.0, 0.0,
    //
    -0.5, -0.5, -0.5,  0.0, -1.0,  0.0, 0.0, 1.0,
     0.5, -0.5, -0.5,  0.0, -1.0,  0.0, 1.0, 1.0,
     0.5, -0.5,  0.5,  0.0, -1.0,  0.0, 1.0, 0.0,
     0.5, -0.5,  0.5,  0.0, -1.0,  0.0, 1.0, 0.0,
    -0.5, -0.5,  0.5,  0.0, -1.0,  0.0, 0.0, 0.0,
    -0.5, -0.5, -0.5,  0.0, -1.0,  0.0, 0.0, 1.0,

     0.5,  0.5, -0.5,  0.0,  1.0,  0.0, 1.0, 1.0,
    -0.5,  0.5, -0.5,  0.0,  1.0,  0.0, 0.0, 1.0,
     0.5,  0.5,  0.5,  0.0,  1.0,  0.0, 1.0, 0.0,
    -0.5,  0.5,  0.5,  0.0,  1.0,  0.0, 0.0, 0.0,
     0.5,  0.5,  0.5,  0.0,  1.0,  0.0, 1.0, 0.0,
    -0.5,  0.5, -0.5,  0.0,  1.0,  0.0, 0.0, 1.0,
]);

/**
 * draw the cube
 */
$context->drawVertexArray($cube);

render_example_context($context);
